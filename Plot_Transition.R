

build_matrix <- function()
{
  
  #all the ones <= 0.10% --> 0
  trans_mat = matrix(c (0.382050449 , 0.26350547 , 0.17473206 , 0.01071777 , 0.01266645 , 0.1313196925 , 0.0192703259 , 0.002273465 , 0.0034643282,
                                0.248689575 , 0.45884294 , 0.14783537 , 0.01446321 , 0.03610949 , 0.0528052804 , 0.0343622598 , 0.005047564 , 0.0018443021,
                                0.128079163 , 0.10204225 , 0.23587620 , 0.12828970 , 0.24815777 , 0.1256228505 , 0.0025264931 , 0.027510703 , 0.0018948698,
                                0.013898081 , 0.02934039 , 0.45797485 , 0.09684536 , 0.39642621 , 0.0008824178 , 0.0000000000 , 0.004632694 , 0.0000000000,
                                0.022444946 , 0.06549972 , 0.46767363 , 0.28049125 , 0.09754376 , 0.0296442687 , 0.0001411632 , 0.036420102 , 0.0001411632,
                                0.228990552 , 0.15688712 , 0.48557931 , 0.00198906 , 0.06190950 , 0.0611636000 , 0.0012431626 , 0.001243163 , 0.0009945301,
                                0.222720478 , 0.59790732 , 0.03587444 , 0.00000000 , 0.00000000 , 0.0029895366 , 0.1405082212 , 0.000000000 , 0.0000000000,
                                0.003778338 , 0.05793451 , 0.45465995 , 0.02770781 , 0.39546600 , 0.0037783375 , 0.0000000000 , 0.056675063 , 0.0000000000,
                                0.297619047 , 0.16666667 , 0.28571429 , 0.01190476 , 0.09523810 , 0.1190476191 , 0.0119047619 , 0.000000000 , 0.0119047619
  ), nrow = 9, ncol = 9, byrow = TRUE)
  
  #[X, Y] = From state X to state Y
  #X = 5
  #Y = 3
  #From state X to state Y
  #This means, X = Row, Y = Column
  
  trans_mat_edited = matrix(c (0.382050449 , 0.26350547 , 0.17473206 , 0 , 0 , 0.1313196925 , 0 , 0 , 0,
                        0.248689575 , 0.45884294 , 0.14783537 , 0 , 0 , 0.0528052804 , 0 , 0 , 0,
                        0.128079163 , 0.10204225 , 0.23587620 , 0.12828970 , 0.24815777 , 0.1256228505 , 0 , 0 , 0,
                        0 , 0 , 0.45797485 , 0 , 0.39642621 , 0 , 0 , 0 , 0,
                        0 , 0 , 0.46767363 , 0.28049125 , 0 , 0 , 0 , 0 , 0,
                        0.228990552 , 0.15688712 , 0.48557931 , 0 , 0 , 0 , 0 , 0 , 0,
                        0.222720478 , 0.59790732 , 0 , 0 , 0 , 0 , 0.1405082212 , 0 , 0,
                        0 , 0 , 0.45465995 , 0 , 0.39546600 , 0 , 0 , 0 , 0,
                        0.297619047 , 0.16666667 , 0.28571429 , 0 , 0 , 0.1190476191 , 0 , 0 ,0
  ), nrow = 9, ncol = 9, byrow = TRUE)
  
  transposed_mat = t(trans_mat_edited)
  
  symbols_states = c("S1", "S2", "S3", "S4", "S5", "S6", "S7", "S8", "S9")
  
  colnames(trans_mat_edited) = symbols_states
  #rownames(trans_mat_edited) = symbols_states
  
  
  library(diagram)
  
  plotmat(transposed_mat, cex=0.8, box.cex=0.8, box.size=0.057, 
          main="Transition Matrix for the AIHMM generated with k = 2 from a sample of Damevski's Dataset 
          (Only showing transition with probability >= 10%)", cex.main = 1.7)
  
  
  
}
